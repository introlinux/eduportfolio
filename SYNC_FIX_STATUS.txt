‚úÖ BUGS DE SINCRONIZACI√ìN - SOLUCIONADOS (VERSI√ìN DESARROLLO)
================================================================
Fecha: 11 de Febrero de 2026
Enfoque: DESARROLLO LOCAL - Reset en lugar de migraciones


üêõ PROBLEMA 1: IM√ÅGENES ROTAS
==============================
S√≠ntoma: Im√°genes no se sincronizan o aparecen rotas

Causa: BA√öL DE PORTFOLIOS BLOQUEADO
El servidor rechaza archivos cuando el ba√∫l est√° encriptado (error 503)

Soluci√≥n:
‚ö†Ô∏è  DESBLOQUEAR EL BA√öL ANTES DE SINCRONIZAR
   1. Abre app de escritorio
   2. Inicia sesi√≥n
   3. Verifica candado abierto
   4. ENTONCES sincroniza desde m√≥vil


üêõ PROBLEMA 2: DROPDOWN CRASH
==============================
S√≠ntoma: Pantallazo rojo al abrir evidencia sincronizada
Error: "There should be exactly one item with [DropdownButton]'s value"

Causa: LA SINCRONIZACI√ìN NO USABA EL ID DEL SERVIDOR
- Creaba asignaturas con IDs auto-incrementados localmente
- Resultado: "Matem√°ticas" con ID=1 en servidor pero ID=6 en m√≥vil
- Dropdown buscaba ID=1 pero solo exist√≠a ID=6 ‚Üí CRASH

Soluciones Implementadas:
‚úÖ sync_repository.dart - Usa ID del servidor remoto
‚úÖ evidence_detail_screen.dart - Valida dropdowns


üìÅ ARCHIVOS MODIFICADOS
========================
‚úÖ lib/features/sync/data/repositories/sync_repository.dart
‚úÖ lib/features/gallery/presentation/screens/evidence_detail_screen.dart


üßπ ENFOQUE SIMPLIFICADO: RESET EN LUGAR DE MIGRAR
==================================================
Como estamos en desarrollo:
‚ùå NO necesitamos migraciones complejas
‚ùå NO necesitamos scripts de limpieza
‚úÖ Simplemente RESETEAMOS y empezamos de cero


üöÄ PROCEDIMIENTO DE RESET COMPLETO
===================================

1. ESCRITORIO (D:\eduportfolio)
   rm -rf data/ portfolios/
   npm start

2. M√ìVIL (D:\eduportfolio-mobile)
   - Desinstalar app del emulador/dispositivo
   - flutter clean
   - flutter pub get
   - flutter run

3. CREAR DATOS DE PRUEBA EN ESCRITORIO
   - A√±adir estudiantes
   - A√±adir evidencias
   - DESBLOQUEAR BA√öL

4. SINCRONIZAR DESDE M√ìVIL
   - Settings ‚Üí Sincronizaci√≥n
   - Conectar con escritorio
   - Sincronizar

5. VERIFICAR
   - IDs deben coincidir entre escritorio y m√≥vil
   - Dropdowns deben funcionar sin errores
   - Im√°genes deben cargarse correctamente


üìä ESTADO ACTUAL
================
| Componente           | Estado |
|----------------------|--------|
| Sync asignaturas     | ‚úÖ Fixed - Usa ID servidor |
| Sync estudiantes     | ‚úÖ OK |
| Sync evidencias      | ‚úÖ OK |
| Sync archivos        | ‚ö†Ô∏è Requiere ba√∫l desbloqueado |
| Dropdown asignaturas | ‚úÖ Fixed - Validaci√≥n a√±adida |
| Dropdown estudiantes | ‚úÖ Fixed - Validaci√≥n a√±adida |


üîç DEBUG
========
M√≥vil:
  flutter logs | grep -E "(Sync|Subject|ERROR)"

Escritorio:
  Ver consola de Node.js

SQL (Escritorio):
  cd D:\eduportfolio\data
  sqlite3 eduportfolio.db
  SELECT * FROM subjects ORDER BY id;


üìÑ DOCUMENTACI√ìN
================
Ver: DESARROLLO_RESET_SIMPLE.md (gu√≠a completa de desarrollo)


‚úÖ PR√ìXIMO PASO
===============
Reset completo ‚Üí Crear datos de prueba ‚Üí Sincronizar ‚Üí Verificar

Si algo falla ‚Üí Reset de nuevo ‚Üí Probar otra vez

Simple y directo para desarrollo local üöÄ
